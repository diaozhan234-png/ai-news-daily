# 工作流名称
name: Daily AI News Push

# 触发规则：定时+手动触发
on:
  # 定时触发（UTC时间1:30 = 北京时间9:30）
  schedule:
    - cron: '30 1 * * *'
  # 手动触发（方便测试）
  workflow_dispatch:

# 工作流任务
jobs:
  push-news:
    # 运行环境（Ubuntu最新版）
    runs-on: ubuntu-latest
    
    # 任务步骤
    steps:
      # 步骤1：拉取仓库代码
      - name: Checkout code
        uses: actions/checkout@v4
      
      # 步骤2：设置Python环境
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'  # Python版本
      
      # 步骤3：安装依赖包
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install requests beautifulsoup4 python-dotenv urllib3
      
      # 步骤4：执行推送脚本
      - name: Run push script
        env:
          # 传递Secrets到脚本环境变量
          FEISHU_WEBHOOK: ${{ secrets.FEISHU_WEBHOOK }}
        run: |
          python ai_news_final.py
